security:
    encoders:
        FOS\UserBundle\Model\UserInterface: sha512

    role_hierarchy:
        ROLE_SUPER_ADMIN:
            - ROLE_ADMIN

            - ROLE_NEWS_ADMIN_CATEGORIES
            - ROLE_NEWS_ADMIN_NEWS

            - ROLE_USER_ADMIN_USERS
            - ROLE_USER_ADMIN_GROUPS

            - ROLE_EVENT_ADMIN_ENTRYTYPES
            - ROLE_EVENT_ADMIN_GAMES
            - ROLE_EVENT_ADMIN_EVENTS
            - ROLE_EVENT_TOURNAMENTS_MANAGER

    providers:
        fos_userbundle:
            id: fos_user.user_provider.username

    firewalls:
        dev:
            pattern:  ^/(_(profiler|wdt)|css|images|js)/
            security: false
        main:
            pattern:         ^/
            form_login:
                provider:    fos_userbundle
                login_path:  fos_user_security_login
                check_path:  fos_user_security_check
                remember_me: true
                csrf_provider:  form.csrf_provider
            remember_me:
                key:         %secret%
                lifetime:    3600
                path:        /
            logout:
                path:        fos_user_security_logout
                target:      /
            anonymous:       true
            switch_user: { role: ROLE_ALLOWED_TO_SWITCH }

    access_control:
        - { path: ^/news/comment, roles: ROLE_USER }

        - { path: ^/admin/news/categories, roles: ROLE_NEWS_ADMIN_CATEGORIES }
        - { path: ^/admin/news, roles: ROLE_NEWS_ADMIN_NEWS }

        - { path: ^/admin/users, roles: ROLE_USER_ADMIN_USERS }
        - { path: ^/admin/groups, roles: ROLE_USER_ADMIN_GROUPS }

        - { path: ^/admin/event/entrytypes, roles: ROLE_EVENT_ADMIN_ENTRYTYPES }
        - { path: ^/admin/event/games, roles: ROLE_EVENT_ADMIN_GAMES }
        - { path: ^/admin/event/events, roles: ROLE_EVENT_ADMIN_EVENTS }

        - { path: ^/admin, roles: ROLE_ADMIN } # Attention Ã  le laisser en dernier
